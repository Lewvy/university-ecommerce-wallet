// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: transactions.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createTransaction = `-- name: CreateTransaction :one
INSERT INTO wallet_transactions (
    user_id,
    amount,
    transaction_type,
    transaction_status,
    related_user_id,
    razorpay_order_id,
    razorpay_payment_id
) VALUES (
    $1, $2, $3, $4, $5, $6, $7
)
RETURNING id, user_id, amount, transaction_status, transaction_type, related_user_id, razorpay_order_id, razorpay_payment_id, metadata, created_at, updated_at
`

type CreateTransactionParams struct {
	UserID            int32
	Amount            int64
	TransactionType   string
	TransactionStatus string
	RelatedUserID     pgtype.Int4
	RazorpayOrderID   pgtype.Text
	RazorpayPaymentID pgtype.Text
}

func (q *Queries) CreateTransaction(ctx context.Context, arg CreateTransactionParams) (WalletTransaction, error) {
	row := q.db.QueryRow(ctx, createTransaction,
		arg.UserID,
		arg.Amount,
		arg.TransactionType,
		arg.TransactionStatus,
		arg.RelatedUserID,
		arg.RazorpayOrderID,
		arg.RazorpayPaymentID,
	)
	var i WalletTransaction
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Amount,
		&i.TransactionStatus,
		&i.TransactionType,
		&i.RelatedUserID,
		&i.RazorpayOrderID,
		&i.RazorpayPaymentID,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const creditWalletBalance = `-- name: CreditWalletBalance :exec
UPDATE wallets
SET balance = balance + $2
WHERE user_id = $1
`

type CreditWalletBalanceParams struct {
	UserID  int32
	Balance int64
}

func (q *Queries) CreditWalletBalance(ctx context.Context, arg CreditWalletBalanceParams) error {
	_, err := q.db.Exec(ctx, creditWalletBalance, arg.UserID, arg.Balance)
	return err
}

const getTransactionAmount = `-- name: GetTransactionAmount :one
SELECT amount FROM wallet_transactions
WHERE id = $1
`

func (q *Queries) GetTransactionAmount(ctx context.Context, id int32) (int64, error) {
	row := q.db.QueryRow(ctx, getTransactionAmount, id)
	var amount int64
	err := row.Scan(&amount)
	return amount, err
}

const getTransactionByOrderID = `-- name: GetTransactionByOrderID :one
SELECT id, user_id, amount, transaction_status, transaction_type, related_user_id, razorpay_order_id, razorpay_payment_id, metadata, created_at, updated_at FROM wallet_transactions
WHERE razorpay_order_id = $1
LIMIT 1
`

func (q *Queries) GetTransactionByOrderID(ctx context.Context, razorpayOrderID pgtype.Text) (WalletTransaction, error) {
	row := q.db.QueryRow(ctx, getTransactionByOrderID, razorpayOrderID)
	var i WalletTransaction
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Amount,
		&i.TransactionStatus,
		&i.TransactionType,
		&i.RelatedUserID,
		&i.RazorpayOrderID,
		&i.RazorpayPaymentID,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateTransactionOrderID = `-- name: UpdateTransactionOrderID :one
UPDATE wallet_transactions
SET razorpay_order_id = $2
WHERE id = $1
RETURNING id, user_id, amount, transaction_status, transaction_type, related_user_id, razorpay_order_id, razorpay_payment_id, metadata, created_at, updated_at
`

type UpdateTransactionOrderIDParams struct {
	ID              int32
	RazorpayOrderID pgtype.Text
}

func (q *Queries) UpdateTransactionOrderID(ctx context.Context, arg UpdateTransactionOrderIDParams) (WalletTransaction, error) {
	row := q.db.QueryRow(ctx, updateTransactionOrderID, arg.ID, arg.RazorpayOrderID)
	var i WalletTransaction
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Amount,
		&i.TransactionStatus,
		&i.TransactionType,
		&i.RelatedUserID,
		&i.RazorpayOrderID,
		&i.RazorpayPaymentID,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateTransactionStatus = `-- name: UpdateTransactionStatus :one
UPDATE wallet_transactions
SET transaction_status = $2, razorpay_payment_id = $3
WHERE id = $1
RETURNING id, user_id, amount, transaction_status, transaction_type, related_user_id, razorpay_order_id, razorpay_payment_id, metadata, created_at, updated_at
`

type UpdateTransactionStatusParams struct {
	ID                int32
	TransactionStatus string
	RazorpayPaymentID pgtype.Text
}

func (q *Queries) UpdateTransactionStatus(ctx context.Context, arg UpdateTransactionStatusParams) (WalletTransaction, error) {
	row := q.db.QueryRow(ctx, updateTransactionStatus, arg.ID, arg.TransactionStatus, arg.RazorpayPaymentID)
	var i WalletTransaction
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.Amount,
		&i.TransactionStatus,
		&i.TransactionType,
		&i.RelatedUserID,
		&i.RazorpayOrderID,
		&i.RazorpayPaymentID,
		&i.Metadata,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
